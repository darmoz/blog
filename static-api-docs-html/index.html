<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Static API html document &middot; </title>
        <meta name="description" content="How to get static html file out of the swagger box">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.76.3" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Static API html document">
<meta property="og:description" content="How to get static html file out of the swagger box">
<meta property="og:type" content="article">
<meta property="og:url" content="https://darmoz.github.io/blog/static-api-docs-html/">
        <link rel="stylesheet" href="https://darmoz.github.io/blogdist/site.css">
        <link rel="stylesheet" href="https://darmoz.github.io/blogdist/syntax.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
        
        
    </head>
    <body>
        

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a href="https://darmoz.github.io/blog">My blog</a>
                            </h1>
                        
                        
                            <a class="button-square" href="https://darmoz.github.io/blogindex.xml" aria-label="RSS"><i class="fa fa-rss" aria-hidden="true"></i></a>
                        
                        
                        
                        
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" aria-label="Send an Email" href="mailto:dariusz.mozgowoj@gmail.com">
                                <i class="fa fa-envelope" aria-hidden="true"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Static API html document</h1>
    
        <p class="post-description" itemprop="description">How to get static html file out of the swagger box</p>
    
    <p class="post-date post-line">
        <span>Published <time datetime="2020-10-11" itemprop="datePublished">Sun, Oct 11, 2020</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="#" itemprop="url" rel="author">Dariusz Mozgowoj</a>
            </span>
        </span>
    </p>
    
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <h2 id="introduction">Introduction</h2>
<p><em>&ldquo;Could you provide some api docs?&quot;</em> I heard recenlty from my colegues which are working on mobile part of the application.
You can ask now&hellip; well where the problem is? We have already swagger and other tools. Unfortunately our team does not want
to expose the api docs as the web resource, so the aim was to create some static output of api docs&hellip; and this was not
as trivial task as I assumed at the beggining.</p>
<h2 id="how-to">How to</h2>
<p>Just for clarification the project was setup with maven and below examples provide information related to maven only.
Moreover tests run in solution was written in <strong>Spock</strong>, however it can be simply adapt to junit if required.</p>
<h3 id="required-repositories-and-dependencies">Required repositories and dependencies</h3>
<p>After some investigation I found that to achieve the goal requires some additional repositories and repository plugins to
get the solution works.</p>
<pre><code>    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-libs-milestone&lt;/id&gt;
            &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;

    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-plugins-release&lt;/id&gt;
            &lt;url&gt;https://repo.spring.io/plugins-release&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;

</code></pre><p>Standard swagger and swagger2markup dependencies are of course also required:</p>
<pre><code> &lt;dependencies&gt;
...
        &lt;dependency&gt;
            &lt;groupId&gt;io.swagger.codegen.v3&lt;/groupId&gt;
            &lt;artifactId&gt;swagger-codegen&lt;/artifactId&gt;
            &lt;version&gt;3.0.21&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.github.swagger2markup&lt;/groupId&gt;
            &lt;artifactId&gt;swagger2markup&lt;/artifactId&gt;
            &lt;version&gt;1.3.3&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
...
&lt;/dependencies&gt;
</code></pre><h3 id="first-step---create-swaggerjson">First step - create swagger.json</h3>
<p>I used swagger to create json version of api documentation. To get this done a test (as presented below) was written.
Test triggered with other tests through CICD pippline each time a new portion of code is merge to master branch.</p>
<p>The test itself:</p>
<pre><code>@SpringBootTest(classes = CoreApplication.class)
class GenerateSwaggerSpec extends Specification {

    @Autowired
    WebApplicationContext context

    def 'generate swagger.json file'() {
        expect:
            MockMvc mockMvc = MockMvcBuilders.webAppContextSetup(context).build()
            File swaggerFile = new File(&quot;target/generated-sources/swagger.json&quot;)
            mockMvc.perform(MockMvcRequestBuilders.get(&quot;/v2/api-docs&quot;).accept(MediaType.APPLICATION_JSON))
                    .andDo({ result -&gt; Files.write(result.getResponse().getContentAsString().getBytes(), swaggerFile) })
    }
}
</code></pre><p>As presented the swagger generated data are get and written to the file predefined in the <strong>target</strong> directory.</p>
<h3 id="second-step---process-swagger-file-trough-swagger2markup">Second step - process swagger file trough swagger2markup</h3>
<p>Swagger.json file needs to then be processed with <strong>swagger2markup</strong> where markup language was in this cas <em><strong>ASCIDOC</strong></em>.
Whole operation needs to be defined <strong>build</strong> block of pom file.
First plugin get the file generated in first step and use specified markup language (ASCIDOC here) to generate output
in this language at location defined in plugin <em>../generated-sources/swagger/</em></p>
<pre><code>&lt;build&gt;
    &lt;plugins&gt;
...
            &lt;plugin&gt;
                &lt;groupId&gt;io.github.swagger2markup&lt;/groupId&gt;
                &lt;artifactId&gt;swagger2markup-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.3.3&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;swaggerInput&gt;${project.build.directory}/generated-sources/swagger.json&lt;/swaggerInput&gt;
                    &lt;outputDir&gt;${project.build.directory}/generated-sources/swagger/&lt;/outputDir&gt;
                    &lt;config&gt;
                        &lt;swagger2markup.markupLanguage&gt;ASCIIDOC&lt;/swagger2markup.markupLanguage&gt;
                    &lt;/config&gt;
                &lt;/configuration&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;prepare-package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;convertSwagger2markup&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
          
        &lt;/plugins&gt;
    &lt;/build&gt;
</code></pre><p>To get this work plugin which build ASCIDOC needs to be used too.</p>
<pre><code>&lt;build&gt;
    &lt;plugins&gt;
...
            &lt;plugin&gt;
                &lt;groupId&gt;org.asciidoctor&lt;/groupId&gt;
                &lt;artifactId&gt;asciidoctor-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.5.3&lt;/version&gt;
                &lt;dependencies&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;org.jruby&lt;/groupId&gt;
                        &lt;artifactId&gt;jruby-complete&lt;/artifactId&gt;
                        &lt;version&gt;1.7.21&lt;/version&gt;
                    &lt;/dependency&gt;
                &lt;/dependencies&gt;
                &lt;configuration&gt;
                    &lt;sourceDirectory&gt;${project.basedir}/src/main/resources/asciidoc/&lt;/sourceDirectory&gt;
                    &lt;sourceDocumentName&gt;index.adoc&lt;/sourceDocumentName&gt;
                    &lt;backend&gt;html5&lt;/backend&gt;
                    &lt;outputDirectory&gt;${project.build.directory}/generated-sources/swagger-html/&lt;/outputDirectory&gt;
                    &lt;attributes&gt;
                        &lt;toc&gt;left&lt;/toc&gt;
                        &lt;toclevels&gt;3&lt;/toclevels&gt;
                        &lt;generated&gt;${project.build.directory}/generated-sources/swagger/&lt;/generated&gt;
                    &lt;/attributes&gt;
                &lt;/configuration&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;output-html&lt;/id&gt;
                        &lt;phase&gt;prepare-package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;process-asciidoc&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
...
        &lt;/plugins&gt;
    &lt;/build&gt;
</code></pre><p>In presented snippet few things are going on. To get better understanding we can read snipped from buttom to top.</p>
<ol>
<li>Plugin read output from swagger2markup -&gt; ASCIDOC processing located in <em>&hellip;/generated-sources/swagger/</em>.</li>
<li>Then the file from location <em>&hellip;/src/main/resources/asciidoc/</em> called *<em>index.adoc</em> is used</li>
<li>Plugin process data and output html static file at location of <em>&hellip;/generated-sources/swagger-html/</em></li>
</ol>
<p>I believe that point 2 needs some more explanation
Mentioned <strong>index.adoc</strong> must be specified upfront in the presented location. The structure of this file is already defined
and should look exactly as in snippet below:</p>
<pre><code>include::{generated}/overview.adoc[]
include::{generated}/paths.adoc[]
include::{generated}/security.adoc[]
include::{generated}/definitions.adoc[]
</code></pre><h3 id="some-more-details-about-the-process">Some more details about the process</h3>
<p>Above structures points to files generated with swagger2markup process and they will be automatically inserted in the order
as described in <strong>index.adoc</strong>.</p>
<h3 id="hint-about-the-cicd">Hint about the CICD</h3>
<p>In the above case <strong>swagger.json</strong> was generated at <em>test</em> stage of CICD pipeline.
The static <strong>html</strong> file was constructed at mid-step between <em>test</em> and <em>deploy</em> stages.
The html-apidocs are available to team members at storage of the cloud solution provider.****</p>

</div>

        <footer class="post-footer clearfix">
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Static%20API%20html%20document&url=https%3a%2f%2fdarmoz.github.io%2fblog%2fstatic-api-docs-html%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" aria-label="Share on Twitter">
                <i class="fa fa-twitter" aria-hidden="true"></i>
            </a>
        

        


        
    </div>
</footer>


        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a href="https://darmoz.github.io/blog">My blog</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#" aria-label="Back to Top">
                        <i class="fa fa-angle-up" aria-hidden="true"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2020 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="https://darmoz.github.io/blogjs/jquery-1.11.3.min.js"></script>
        <script src="https://darmoz.github.io/blogjs/jquery.fitvids.js"></script>
        <script src="https://darmoz.github.io/blogjs/scripts.js"></script>
    </body>
</html>

